template(name="dash")
  div(style="display:none") #{updatePanes}
  unless ready
    .loading-message
      +spinner
      h1 Please wait...
  else
    if error
      .loading-message
        h2 There was an error processing this diagnosis.
        a.btn.btn-default.rediagnose Retry
  .dashboard-container
    .left-panel.diagnosis
      .btn-group.btn-group-justified(style="margin-top:5px;")
        a.btn.btn-default(href='/search?diagnosisId=#{_id}') Find Similar Articles
      h4 Diagnosis
        span.btn-group.btn-group-xs(style="float:right;")
          a.btn.btn-default(href='/symptomTable/#{_id}') Detailed diagnosis
          a.btn.btn-default.open-feedback Feedback
      +reactiveTable collection=diseases settings=tableSettings
      .btn-group.btn-group-justified.btn-group-sm
        if prevDiagnosisId
          unless prevDiagnosisError
            a.btn.btn-default.prev-diagnosis(href='/dash/#{prevDiagnosisId}') Previous Diagnosis
        if updatedDiagnosisId
          a.btn.btn-default.prev-diagnosis(href='/dash/#{updatedDiagnosisId}') Updated Diagnosis
        else
          a.btn.btn-default.rediagnose Rediagnose
      +feedback
      .features
        if showCategory 'symptom'
          .feature-section.symptoms
            h4 Symptoms
            each keywords
              if hasCategory categories 'symptom'
                .label(style="background-color:{{color}}") #{name}
        if showCategory 'host'
          .feature-section.hosts
            h4 Hosts
            each keywords
              if hasCategory categories 'host'
                .label(style="background-color:{{color}}") #{name}
        if showCategory 'pathogen'
          .feature-section.pathogens
            h4 Pathogens
            each keywords
              if hasCategory categories 'pathogen'
                .label(style="background-color:{{color}}") #{name}
        if showCategory 'transmi'
          .feature-section.transmission
            h4 Modes of Transmission
            each keywords
              if hasCategory categories 'transmi'
                .label(style="background-color:{{color}}") #{name}
        if showCategory 'patientInfo'
          .feature-section.hospitalization-counts
            h4 Patient Information
            each features
              if eq type "patientInfo"
                .patient-description
                  if count
                    b Cases: 
                    if count.approximate
                      | ~
                    if count.number
                      | #{count.number}
                    if count.range_start
                      | #{count.range_start} - #{count.range_end}
                    if count.death
                      | deaths
                    if count.hospitalization
                      | hospitalizations
                    br
                  if age
                    b Age:
                    if age.child
                      | Child
                    if age.approximate
                      | ~
                    if age.number
                      | #{age.number}
                    if age.range_start
                      | #{age.range_start} - #{age.range_end}
                    if age.month_units
                      | months old
                    else
                      if age.year_units
                        | years old
                    br
                  if male
                    b Sex:
                    | male
                  if female
                    b Sex:
                    | female
        if showCategory 'datetime'
          .feature-section.dates
            h4 Dates
            each features
              if eq type "datetime"
                .label #{formatDate}
        if showCategory 'location'
          .feature-section.locations
            h4 Locations
            each features
              if eq type "location"
                .label.location #{formatLocation}
    .pane-container
      .pane.minimized
        +geomapSimple
      .pane.minimized
        +timelineSimple
      //-.pane
      //-  +dendrogram
      .pane.maximized
        +text
